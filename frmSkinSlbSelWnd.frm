VERSION 5.00
Object = "{E2D000D1-2DA1-11D2-B358-00104B59D73D}#1.0#0"; "Text60.ocx"
Object = "{5E9E78A0-531B-11CF-91F6-C2863C385E30}#1.0#0"; "msflxgrd.ocx"
Begin VB.Form frmSkinSlbSelWnd 
   BackColor       =   &H00C0FFFF&
   Caption         =   "ÉXÉâÉuîßí≤ç∏ì¸óÕÅ|ÉXÉâÉuëIë"
   ClientHeight    =   11280
   ClientLeft      =   60
   ClientTop       =   525
   ClientWidth     =   16035
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   ScaleHeight     =   11280
   ScaleWidth      =   16035
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.CommandButton cmdStatChgMode 
      Caption         =   "èÛë‘ïœçX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   540
      Left            =   14040
      TabIndex        =   24
      Top             =   960
      Width           =   1800
   End
   Begin VB.CommandButton cmdStatChgFix 
      Caption         =   "èÛë‘åàíË"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   540
      Left            =   14040
      TabIndex        =   23
      Top             =   1680
      Width           =   1800
   End
   Begin VB.Frame Frame_Status 
      BackColor       =   &H00C0FFFF&
      Caption         =   "êVãKì¸óÕÅ|èÛë‘ëIë"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1875
      Left            =   7260
      TabIndex        =   15
      Top             =   600
      Width           =   6675
      Begin VB.OptionButton OptStatus 
         BackColor       =   &H00C0FFFF&
         Caption         =   "6:6htå„"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Index           =   6
         Left            =   4980
         TabIndex        =   22
         Top             =   1140
         Width           =   1455
      End
      Begin VB.OptionButton OptStatus 
         BackColor       =   &H00C0FFFF&
         Caption         =   "5:5htå„"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Index           =   5
         Left            =   3420
         TabIndex        =   21
         Top             =   1140
         Width           =   1515
      End
      Begin VB.OptionButton OptStatus 
         BackColor       =   &H00C0FFFF&
         Caption         =   "4:4htå„"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   390
         Index           =   4
         Left            =   1860
         TabIndex        =   20
         Top             =   1140
         Width           =   1515
      End
      Begin VB.OptionButton OptStatus 
         BackColor       =   &H00C0FFFF&
         Caption         =   "2:2htå„"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Index           =   2
         Left            =   3420
         TabIndex        =   19
         Top             =   480
         Width           =   1455
      End
      Begin VB.OptionButton OptStatus 
         BackColor       =   &H00C0FFFF&
         Caption         =   "1:1htå„"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Index           =   1
         Left            =   1860
         TabIndex        =   18
         Top             =   480
         Width           =   1515
      End
      Begin VB.OptionButton OptStatus 
         BackColor       =   &H00C0FFFF&
         Caption         =   "0:çïîÁ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Index           =   0
         Left            =   360
         TabIndex        =   17
         Top             =   480
         Value           =   -1  'True
         Width           =   1455
      End
      Begin VB.OptionButton OptStatus 
         BackColor       =   &H00C0FFFF&
         Caption         =   "3:3htå„"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   390
         Index           =   3
         Left            =   4980
         TabIndex        =   16
         Top             =   480
         Width           =   1515
      End
   End
   Begin VB.PictureBox PicSigYellow 
      Height          =   315
      Left            =   9120
      Picture         =   "frmSkinSlbSelWnd.frx":0000
      ScaleHeight     =   255
      ScaleWidth      =   495
      TabIndex        =   14
      Top             =   10320
      Visible         =   0   'False
      Width           =   555
   End
   Begin imText6Ctl.imText imTextSearchSlbNumber 
      Height          =   525
      Left            =   1800
      TabIndex        =   0
      Top             =   1980
      Width           =   3360
      _Version        =   65536
      _ExtentX        =   5927
      _ExtentY        =   926
      Caption         =   "frmSkinSlbSelWnd.frx":0644
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      DropDown        =   "frmSkinSlbSelWnd.frx":06B2
      Key             =   "frmSkinSlbSelWnd.frx":06D0
      BackColor       =   -2147483643
      EditMode        =   3
      ForeColor       =   -2147483640
      ReadOnly        =   0
      ShowContextMenu =   1
      MarginLeft      =   1
      MarginRight     =   1
      MarginTop       =   1
      MarginBottom    =   1
      Enabled         =   -1
      MousePointer    =   0
      Appearance      =   1
      BorderStyle     =   1
      AlignHorizontal =   0
      AlignVertical   =   0
      MultiLine       =   0
      ScrollBars      =   0
      PasswordChar    =   ""
      AllowSpace      =   -1
      Format          =   "A9#@"
      FormatMode      =   0
      AutoConvert     =   -1
      ErrorBeep       =   1
      MaxLength       =   10
      LengthAsByte    =   0
      Text            =   ""
      Furigana        =   0
      HighlightText   =   -1
      IMEMode         =   3
      IMEStatus       =   0
      DropWndWidth    =   0
      DropWndHeight   =   0
      ScrollBarMode   =   0
      MoveOnLRKey     =   0
      OLEDragMode     =   0
      OLEDropMode     =   0
   End
   Begin VB.Frame Frame_InputMode 
      BackColor       =   &H00C0FFFF&
      Caption         =   "ì¸óÕÉÇÅ[ÉhëIë"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1275
      Left            =   180
      TabIndex        =   8
      Top             =   600
      Width           =   6855
      Begin VB.OptionButton OptInputMode 
         BackColor       =   &H00C0FFFF&
         Caption         =   "êVãK"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   390
         Index           =   0
         Left            =   240
         TabIndex        =   2
         Top             =   540
         Value           =   -1  'True
         Width           =   1275
      End
      Begin VB.OptionButton OptInputMode 
         BackColor       =   &H00C0FFFF&
         Caption         =   "èCê≥"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   390
         Index           =   1
         Left            =   2160
         TabIndex        =   3
         Top             =   540
         Width           =   1155
      End
      Begin VB.OptionButton OptInputMode 
         BackColor       =   &H00C0FFFF&
         Caption         =   "çÌèú"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   450
         Index           =   2
         Left            =   3900
         TabIndex        =   4
         Top             =   540
         Width           =   1215
      End
   End
   Begin VB.PictureBox PicSigRed 
      Height          =   315
      Left            =   9120
      Picture         =   "frmSkinSlbSelWnd.frx":0714
      ScaleHeight     =   255
      ScaleWidth      =   495
      TabIndex        =   11
      Top             =   9960
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.PictureBox PicSigGreen 
      Height          =   315
      Left            =   9120
      Picture         =   "frmSkinSlbSelWnd.frx":0D56
      ScaleHeight     =   255
      ScaleWidth      =   495
      TabIndex        =   10
      Top             =   10680
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.CommandButton cmdCANCEL 
      Caption         =   "ñﬂÇÈ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   600
      Left            =   12120
      TabIndex        =   7
      Top             =   9900
      Width           =   1800
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   600
      Left            =   10140
      TabIndex        =   6
      Top             =   9900
      Width           =   1800
   End
   Begin VB.CommandButton cmdSearch 
      Caption         =   "åüçı"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   540
      Left            =   5220
      TabIndex        =   1
      Top             =   1980
      Width           =   1800
   End
   Begin MSFlexGridLib.MSFlexGrid MSFlexGrid1 
      Height          =   7095
      Left            =   180
      TabIndex        =   5
      Top             =   2640
      Width           =   13755
      _ExtentX        =   24262
      _ExtentY        =   12515
      _Version        =   393216
      Rows            =   21
      Cols            =   10
      FixedCols       =   0
      BackColorSel    =   -2147483643
      ForeColorSel    =   -2147483640
      ScrollBars      =   2
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Label lbl_nMSFlexGrid1_Selected_Row 
      Height          =   315
      Left            =   1140
      TabIndex        =   12
      Top             =   9900
      Visible         =   0   'False
      Width           =   1095
   End
   Begin VB.Label Label3 
      Alignment       =   2  'íÜâõëµÇ¶
      BackStyle       =   0  'ìßñæ
      Caption         =   "ÉXÉâÉuîßí≤ç∏ì¸óÕÅ|ÉXÉâÉuëIë"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   615
      Left            =   0
      TabIndex        =   13
      Top             =   0
      Width           =   14115
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'ìßñæ
      Caption         =   "ÉXÉâÉuNo."
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   555
      Left            =   180
      TabIndex        =   9
      Top             =   1980
      Width           =   1635
   End
End
Attribute VB_Name = "frmSkinSlbSelWnd"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
' @(h) frmSkinSlbSelWnd.Frm                ver 1.00 ( '2008.04.16 SystEx Ayumi Kikuchi )

' @(s)
' ÉXÉâÉuîßí≤ç∏ì¸óÕÅ|ÉXÉâÉuëIëï\é¶ÉtÉHÅ[ÉÄ
' Å@ñ{ÉÇÉWÉÖÅ[ÉãÇÕÉXÉâÉuîßí≤ç∏ì¸óÕÅ|ÉXÉâÉuëIëï\é¶ÉtÉHÅ[ÉÄÇ≈égópÇ∑ÇÈ
' Å@ÇΩÇﬂÇÃÇ‡ÇÃÇ≈Ç†ÇÈÅB

Option Explicit

Private nMSFlexGrid1_Selected_Row As Integer ''ÉOÉäÉbÉhÇPëIëçsî‘çÜäiî[
Private bMouseControl As Boolean ''É}ÉEÉXÉRÉìÉgÉçÅ[ÉãÉtÉâÉOäiî[
Private bOptInputModeValue(0 To 2) As Boolean

' @(f)
'
' ã@î\      : ÉLÉÉÉìÉZÉãÉ{É^Éì
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉLÉÉÉìÉZÉãÉ{É^ÉìèàóùÅB
'
' îıçl      :COLORSYS
'
Private Sub cmdCancel_Click()
    Call SlbSelLock(False)
    Call fMainWnd.CallBackMessage(CALLBACK_MAIN_RETSKINSLBSELWND, CALLBACK_ncResCANCEL)
    Unload Me
End Sub

' @(f)
'
' ã@î\      : ÇnÇjÉ{É^Éì
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÇnÇjÉ{É^ÉìèàóùÅB
'
' îıçl      :COLORSYS
'
Private Sub cmdOK_Click()
    Dim bRet As Boolean
    Dim strSource As String
    Dim strDestination As String
    
    cmdOK.Enabled = False ''òAë≈ã÷é~ÅI
    
    Dim MsgWnd As Message
    Set MsgWnd = New Message
    
    APSlbCont.nListSelectedIndexP1 = nMSFlexGrid1_Selected_Row
    
    'ÉXÉâÉuëIëÉ`ÉFÉbÉN
    If APSlbCont.nListSelectedIndexP1 = 0 Then
        Select Case APSlbCont.nSearchInputModeSelectedIndex
            Case 0 'êVãK
                Call WaitMsgBox(Me, "é¿ê—ì¸óÕÇçsÇ§ÉXÉâÉuÇëIëÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB")
            Case 1 'èCê≥
                Call WaitMsgBox(Me, "é¿ê—èCê≥ÇçsÇ§ÉXÉâÉuÇëIëÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB")
            Case 2 'çÌèú
                Call WaitMsgBox(Me, "é¿ê—çÌèúÇçsÇ§ÉXÉâÉuÇëIëÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB")
        End Select
        
        cmdOK.Enabled = True 'É{É^ÉìóLå¯
        
        Exit Sub
    End If
    
    
    '********************************************************************************************
    'DEBUG POINT êVãKÉÇÅ[ÉhÇ≈ÉäÉXÉgï\é¶ÇÃèÍçáÅAèCê≥ëŒè€ÉåÉRÅ[ÉhÇ‡ìØéûÇ…ï\é¶Ç≥ÇÍÇÈÇÃÇ≈ÅA
    'ÉäÉXÉgëIëå„ÅAêVãKÇ≈ÇÕÇ»Ç≠ÅAèCê≥ÇÉÜÅ[ÉUÅ[Ç™ëIÇÒÇæèÍçáÇÕÅAÇ‡Ç§àÍìxÉÇÅ[ÉhÇÉ`ÉFÉbÉNÇµÅA
    'êVãKÅ^èCê≥ÇÃêÿë÷Ç¶Ç™ïKóv
    '********************************************************************************************
    'êVãKÉÇÅ[ÉhÇ©ÅH
    If APSlbCont.nSearchInputModeSelectedIndex = 0 Then
        'ëIëÇµÇΩÉXÉâÉuÇÕêVãKÇ©ÅH
        If APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).sys_wrt_dte = "" Then
            'êVãKÉÇÅ[Éh
        Else
            'ï€ë∂çœÇ›Ç≈Ç†ÇÈà◊ÅAèCê≥ÉÇÅ[ÉhÇ…é©ìÆïœçX
            APSlbCont.nSearchInputModeSelectedIndex = 1
        End If
    End If
    
    
    'ÇcÇaèàóùÇ™î≠ê∂Ç∑ÇÈÉÇÅ[ÉhÅ@èCê≥Å^çÌèú
    If APSlbCont.nSearchInputModeSelectedIndex <> 0 Then

        Select Case APSlbCont.nSearchInputModeSelectedIndex
            Case 1 'èCê≥
                MsgWnd.MsgText = "ÉfÅ[É^ÉxÅ[ÉXÇ©ÇÁÉXÉâÉuèÓïÒÇì«çûÇ›íÜÇ≈Ç∑ÅB" & vbCrLf & "ÇµÇŒÇÁÇ≠Ç®ë“ÇøÇ≠ÇæÇ≥Ç¢ÅB"
            Case 2 'çÌèú
                MsgWnd.MsgText = "ÉfÅ[É^ÉxÅ[ÉXÇ©ÇÁÉXÉâÉuèÓïÒÇçÌèúíÜÇ≈Ç∑ÅB" & vbCrLf & "ÇµÇŒÇÁÇ≠Ç®ë“ÇøÇ≠ÇæÇ≥Ç¢ÅB"
        End Select

        MsgWnd.OK.Visible = False
        MsgWnd.Show vbModeless, Me
        MsgWnd.Refresh
    
    End If
    
    'é¿ê—èàóùÉGÉäÉAÇ÷ÉfÅ[É^ÉRÉsÅ[
    Call init_APResData
    Select Case APSlbCont.nSearchInputModeSelectedIndex
        Case 0 'êVãK
            APResData.slb_no = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_no ''ÉXÉâÉuÉ`ÉÉÅ[ÉWNO
            APResData.slb_chno = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_chno ''ÉXÉâÉuÉ`ÉÉÅ[ÉWNO
            APResData.slb_aino = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_aino ''ÉXÉâÉuçáî‘
            APResData.slb_stat = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_stat ''èÛë‘
            'APResData.slb_col_cnt = APSozaiData.       ''ÉJÉâÅ[âÒêî
            APResData.slb_ccno = APSozaiData.slb_ccno           ''ÉXÉâÉuCCNO
            APResData.slb_zkai_dte = APSozaiData.slb_zkai_dte   ''ë¢âÚì˙
            APResData.slb_ksh = APSozaiData.slb_ksh             ''ç|éÌ
            APResData.slb_typ = APSozaiData.slb_typ             ''å^
            APResData.slb_uksk = APSozaiData.slb_uksk           ''å¸êÊ
            APResData.slb_wei = APSozaiData.slb_skin_wei        ''èdó ÅiΩ◊ÃﬁîßópÅj
            APResData.slb_lngth = APSozaiData.slb_lngth         ''í∑Ç≥
            APResData.slb_wdth = APSozaiData.slb_wdth           ''ïù
            APResData.slb_thkns = APSozaiData.slb_thkns         ''å˙Ç›
            
            '2008/09/01 SystEx. A.K êVãKÇÃèÍçáÅAëOâÒÉfÅ[É^Åiï€éùíÜÉfÅ[É^ÅjÇÉZÉbÉgÇ∑ÇÈÅB
            APResData.slb_wrt_nme = APSysCfgData.NowStaffName(conDefine_SYSMODE_SKIN) 'ÉXÉ^ÉbÉtñº
            APResData.slb_nxt_prcs = APSysCfgData.NowNextProcess(conDefine_SYSMODE_SKIN) 'éüçHíˆ
            
            'êVãKÇÃèÍçáÇÕÅASCANÉCÉÅÅ[ÉWÇèâä˙âªÇ∑ÇÈÅBÅiíÜä‘ÉtÉ@ÉCÉãÇÃçÌèúÅj
            strDestination = App.path & "\" & conDefine_ImageDirName & "\" & "SKIN.JPG"
            'ÉCÉÅÅ[ÉWñ≥Çµ
            If Dir(strDestination) <> "" Then
                Kill strDestination
            End If
            
            ' 20090115 add by M.Aoyagi    âÊëúñáêîí«â¡ÇÃà◊
            APResData.PhotoImgCnt = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).PhotoImgCnt1
            
        Case 1 'èCê≥
            'é¿ê—ÉfÅ[É^ì«çûÇ›
            bRet = TRTS0012_Read(APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_no, _
                                 APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_stat)
            If UBound(APResTmpData) = 1 Then
                APResData = APResTmpData(0)
            End If
            If bRet = False Then
                Call WaitMsgBox(Me, "ÉfÅ[É^ÉxÅ[ÉXì«çûÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB")
                MsgWnd.OK_Close
                
                cmdOK.Enabled = True 'É{É^ÉìóLå¯
                Exit Sub
            End If
            
            'ìoò^çœÇ›SCANÉCÉÅÅ[ÉWÇ™Ç†ÇÈÇ©ÅH
            strDestination = App.path & "\" & conDefine_ImageDirName & "\" & "SKIN.JPG"
            If APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).bAPScanInput Then
                'ìoò^çœÇ›SCANÉCÉÅÅ[ÉWÇì«çûÇ› (conDefine_ImageDirName = TEMP)
                strSource = APSysCfgData.SHARES_SCNDIR & "\SKIN" & "\" & APResData.slb_chno & "\" & APResData.slb_aino & _
                                                         "\SKIN" & "_" & APResData.slb_chno & "_" & APResData.slb_aino & _
                                                         "_" & APResData.slb_stat & "_00.JPG"
                On Error GoTo cmdOK_Click_File_err:
                Call FileCopy(strSource, strDestination)
                On Error GoTo 0
            Else
                'ÉCÉÅÅ[ÉWñ≥Çµ
                If Dir(strDestination) <> "" Then
                    Kill strDestination
                End If
            End If
            
            ' 20090115 add by M.Aoyagi    âÊëúñáêîí«â¡ÇÃà◊
            APResData.PhotoImgCnt = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).PhotoImgCnt1
            
        Case 2 'çÌèú
        
            MsgWnd.OK_Close
            Call SkinDataDel_REQ
            Exit Sub
    End Select
    
    'ÇcÇaèàóùÇ™î≠ê∂Ç∑ÇÈÉÇÅ[ÉhÅ@èCê≥Å^çÌèúÅiì«çûíÜÉÅÉbÉZÅ[ÉWï\é¶óLÇËÅj
    If APSlbCont.nSearchInputModeSelectedIndex <> 0 Then
        MsgWnd.OK_Close
    End If
    
    cmdOK.Enabled = True 'É{É^ÉìóLå¯
    
    Call OKcmdOK 'ì¸óÕäJén(unload me)
    
    Exit Sub
    
cmdOK_Click_File_err:
    Call MsgLog(conProcNum_MAIN, Err.Source + " " + _
        CStr(Err.Number) + Chr(13) + Err.Description)
    
    Call MsgLog(conProcNum_MAIN, "cmdOK_Click_File FILECOPY SO=" & strSource & " DE=" & strDestination)
    Call WaitMsgBox(Me, "ï€ë∂çœÇ›ÉXÉLÉÉÉiÅ[ÉCÉÅÅ[ÉWÉtÉ@ÉCÉãÇÃì«çûÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB" & vbCrLf & vbCrLf & "FILECOPY SO=" & strSource & " DE=" & strDestination)
    
    MsgWnd.OK_Close
    On Error GoTo 0
    
    cmdOK.Enabled = True 'É{É^ÉìóLå¯
    Exit Sub
    
End Sub

Private Sub SkinDataDel()
    Dim bRet As Boolean
    
    '*********
    'çÌèúèàóù
    '*********
    APResData.slb_no = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_no
    APResData.slb_stat = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_stat
    bRet = TRTS0012_Write(True)
    If bRet = False Then
        Call WaitMsgBox(Me, "ÉfÅ[É^ÉxÅ[ÉXì«çûÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB")
        Exit Sub
    End If
    
    bRet = TRTS0050_Write(True)
    If bRet = False Then
        Call WaitMsgBox(Me, "ÉfÅ[É^ÉxÅ[ÉXì«çûÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB")
        Exit Sub
    End If
    
    '*********
    'åüçıåãâ ÉäÉXÉgçƒï\é¶
    '*********
    Call WaitMsgBox(Me, "çÌèúèàóùÇ™ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB")
    Call cmdSearch_Click

End Sub

' @(f)
'
' ã@î\      : ÉXÉâÉuëIëèàóùÇnÇjèIóπ
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉXÉâÉuëIëèàóùÇnÇjí ímÅB
'
' îıçl      : ÉRÅ[ÉãÉoÉbÉNÇ…ÇƒÇnÇjí ímå„ÉAÉìÉçÅ[ÉhÅB
'
Private Sub OKcmdOK()

    Call fMainWnd.CallBackMessage(CALLBACK_MAIN_RETSKINSLBSELWND, CALLBACK_ncResOK)
    Unload Me

End Sub

' @(f)
'
' ã@î\      : ÉXÉâÉuèÓïÒåüçıÉ{É^Éì
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉXÉâÉuèÓïÒÇÃåüçıÇçsÇ§ÅB
'
' îıçl      : ÉXÉâÉuåüçıåãâ ï\é¶ÉGÉäÉA
'
Private Sub cmdSearch_Click()
    Dim nWildCard As Integer
    Dim nI As Integer
    Dim nJ As Integer
    Dim nSEARCH_MAX As Integer
    Dim bRet As Boolean
    Dim strSearchSlbNumber As String 'é¿ç€ÇÃåüçıï∂éöóÒ
    Dim strTmpSlbNumber As String 'î‰äróp
    Dim bCmp As Boolean 'î‰äróp
    Dim strChkChar As String
    
    Dim bNoRecord As Boolean '2008/08/30 A.K
    
    Dim MsgWnd As Message
    Set MsgWnd = New Message
    
    'çƒåüçıéûÇÕèâä˙âª
    strSearchSlbNumber = ""
    Call InitMSFlexGrid1
    
    nWildCard = 0
    'ÉnÉCÉtÉìÅfÅ|ÅfÇéÊÇ¡Çƒé¿ç€ÇÃåüçıï∂éöóÒÇ÷ÉZÉbÉg
    strSearchSlbNumber = ConvSearchSlbNumber(imTextSearchSlbNumber.Text)
    
    'ì¸óÕÉÇÅ[Éh
    If OptInputMode(0).Value Then 'êVãK
        APSlbCont.nSearchInputModeSelectedIndex = 0 'ì¸óÕÉÇÅ[ÉhÉIÉvÉVÉáÉìéwíËÉCÉìÉfÉbÉNÉXî‘çÜ
        
        If OptStatus(0).Value Then
            APSlbCont.nSearchInputStatusSelectedIndex = 0 'çïîÁ
        ElseIf OptStatus(1).Value Then
            APSlbCont.nSearchInputStatusSelectedIndex = 1 '1htå„
        ElseIf OptStatus(2).Value Then
            APSlbCont.nSearchInputStatusSelectedIndex = 2 '2htå„
        ElseIf OptStatus(3).Value Then
            APSlbCont.nSearchInputStatusSelectedIndex = 3 '3htå„
        ElseIf OptStatus(4).Value Then
            APSlbCont.nSearchInputStatusSelectedIndex = 4 '4htå„
        ElseIf OptStatus(5).Value Then
            APSlbCont.nSearchInputStatusSelectedIndex = 5 '5htå„
        ElseIf OptStatus(6).Value Then
            APSlbCont.nSearchInputStatusSelectedIndex = 6 '6htå„
        End If
    ElseIf OptInputMode(1).Value Then 'èCê≥
        APSlbCont.nSearchInputModeSelectedIndex = 1 'ì¸óÕÉÇÅ[ÉhÉIÉvÉVÉáÉìéwíËÉCÉìÉfÉbÉNÉXî‘çÜ
        APSlbCont.nSearchInputStatusSelectedIndex = 0 'ñ≥å¯ÅiégópÇµÇ»Ç¢Åj
    ElseIf OptInputMode(2).Value Then 'çÌèú
        APSlbCont.nSearchInputModeSelectedIndex = 2 'ì¸óÕÉÇÅ[ÉhÉIÉvÉVÉáÉìéwíËÉCÉìÉfÉbÉNÉXî‘çÜ
        APSlbCont.nSearchInputStatusSelectedIndex = 0 'ñ≥å¯ÅiégópÇµÇ»Ç¢Åj
    End If
    
    nWildCard = InStr(1, strSearchSlbNumber, "%", vbTextCompare)
    
    'RIAL
    ReDim APSearchListSlbData(0)
    
    'êVãKÉÇÅ[ÉhÅiåüçıÇ≈ÉèÉCÉãÉhÉJÅ[Éhïsâ¬Åj
    If OptInputMode(0).Value Then
        'ãÛîíéwíËÇÕïsâ¬ÅB
        If LenB(imTextSearchSlbNumber.Text) = 0 Then
            Call WaitMsgBox(Me, "ÉXÉâÉuÇmÇèÅDÇì¸óÕÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'ÉèÉCÉãÉhÉJÅ[Éhïsâ¬ÅB
        If nWildCard <> 0 Then
            Call WaitMsgBox(Me, "êVãKÉÇÅ[ÉhÇ≈ÉèÉCÉãÉhÉJÅ[ÉhÇÃéwíËÇÕèoóàÇ‹ÇπÇÒÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'ÉèÉCÉãÉhÉJÅ[Éhñ≥ÇµÇ≈ÅAÇXï∂éöÇÊÇËëΩÇ¢èÍçáÇÕïsâ¬ÅB
        If (nWildCard = 0) And (Len(strSearchSlbNumber) > 9) Then
            Call WaitMsgBox(Me, "ÉXÉâÉuÇmÇèÅDÇÃåÖêîÇ™ïsê≥Ç≈Ç∑ÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'ÉèÉCÉãÉhÉJÅ[Éhñ≥ÇµÇ≈ÅAÇUï∂éöÇÊÇËè≠Ç»Ç¢èÍçáÇÕïsâ¬ÅB
        If (nWildCard = 0) And (Len(strSearchSlbNumber) < 6) Then
            Call WaitMsgBox(Me, "ÉXÉâÉuÇmÇèÅDÇÃåÖêîÇ™ïsê≥Ç≈Ç∑ÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'êÊì™Ç©ÇÁÇTï∂éöÇ‹Ç≈ÇÕÅA0Ç©ÇÁ9à»äOÇïsâ¬ÅB
        For nI = 1 To 5
            If nI > Len(strSearchSlbNumber) Then Exit For
            strChkChar = Mid(strSearchSlbNumber, nI, 1)
            If strChkChar >= "0" And strChkChar <= "9" Then
                'OK
            Else
                'NG
                Call WaitMsgBox(Me, "êÊì™Ç©ÇÁÇTï∂éöÇ‹Ç≈ÅA0Ç©ÇÁ9à»äOÇÃéwíËÇÕèoóàÇ‹ÇπÇÒÅB")
                imTextSearchSlbNumber.SetFocus
                Exit Sub
            End If
        Next nI
    
    
    'èCê≥ÉÇÅ[ÉhÅiåüçıÇ≈ÉèÉCÉãÉhÉJÅ[Éhâ¬Åj
    ElseIf OptInputMode(1).Value Then
        'ãÛîíéwíËÇÕïsâ¬ÅB
        If LenB(imTextSearchSlbNumber.Text) = 0 Then
            Call WaitMsgBox(Me, "ÉXÉâÉuÇmÇèÅDÇì¸óÕÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'ÉèÉCÉãÉhÉJÅ[ÉhÇPÇ¬ÇÃÇ›ÇÕïsâ¬ÅB
        If strSearchSlbNumber = "%" Then
            Call WaitMsgBox(Me, "ÉèÉCÉãÉhÉJÅ[ÉhÇÃéwíËï˚ñ@Ç™ê≥ÇµÇ≠Ç†ÇËÇ‹ÇπÇÒÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'ÉèÉCÉãÉhÉJÅ[Éhñ≥ÇµÇ≈ÅAÇXï∂éöÇÊÇËëΩÇ¢èÍçáÇÕïsâ¬ÅB
        If (nWildCard = 0) And (Len(strSearchSlbNumber) > 9) Then
            Call WaitMsgBox(Me, "ÉXÉâÉuÇmÇèÅDÇÃåÖêîÇ™ïsê≥Ç≈Ç∑ÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'ÉèÉCÉãÉhÉJÅ[Éhñ≥ÇµÇ≈ÅAÇUï∂éöÇÊÇËè≠Ç»Ç¢èÍçáÇÕïsâ¬ÅB
        If (nWildCard = 0) And (Len(strSearchSlbNumber) < 6) Then
            Call WaitMsgBox(Me, "ÉXÉâÉuÇmÇèÅDÇÃåÖêîÇ™ïsê≥Ç≈Ç∑ÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'êÊì™Ç©ÇÁÇTï∂éöÇ‹Ç≈ÇÕÅA0Ç©ÇÁ9,*à»äOÇïsâ¬ÅB
        For nI = 1 To 5
            If nI > Len(strSearchSlbNumber) Then Exit For
            strChkChar = Mid(strSearchSlbNumber, nI, 1)
            If strChkChar >= "0" And strChkChar <= "9" Then
                'OK
            ElseIf strChkChar = "%" Then
                'OK
            Else
                'NG
                Call WaitMsgBox(Me, "êÊì™Ç©ÇÁÇTï∂éöÇ‹Ç≈ÅA0Ç©ÇÁ9,*à»äOÇÃéwíËÇÕèoóàÇ‹ÇπÇÒÅB")
                imTextSearchSlbNumber.SetFocus
                Exit Sub
            End If
        Next nI
    
    'çÌèúÉÇÅ[ÉhÅiåüçıÇ≈ÉèÉCÉãÉhÉJÅ[Éhâ¬Åj
    ElseIf OptInputMode(2).Value Then
        'ãÛîíéwíËÇÕïsâ¬ÅB
        If LenB(imTextSearchSlbNumber.Text) = 0 Then
            Call WaitMsgBox(Me, "ÉXÉâÉuÇmÇèÅDÇì¸óÕÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'ÉèÉCÉãÉhÉJÅ[ÉhÇPÇ¬ÇÃÇ›ÇÕïsâ¬ÅB
        If strSearchSlbNumber = "%" Then
            Call WaitMsgBox(Me, "ÉèÉCÉãÉhÉJÅ[ÉhÇÃéwíËï˚ñ@Ç™ê≥ÇµÇ≠Ç†ÇËÇ‹ÇπÇÒÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'ÉèÉCÉãÉhÉJÅ[Éhñ≥ÇµÇ≈ÅAÇXï∂éöÇÊÇËëΩÇ¢èÍçáÇÕïsâ¬ÅB
        If (nWildCard = 0) And (Len(strSearchSlbNumber) > 9) Then
            Call WaitMsgBox(Me, "ÉXÉâÉuÇmÇèÅDÇÃåÖêîÇ™ïsê≥Ç≈Ç∑ÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'ÉèÉCÉãÉhÉJÅ[Éhñ≥ÇµÇ≈ÅAÇUï∂éöÇÊÇËè≠Ç»Ç¢èÍçáÇÕïsâ¬ÅB
        If (nWildCard = 0) And (Len(strSearchSlbNumber) < 6) Then
            Call WaitMsgBox(Me, "ÉXÉâÉuÇmÇèÅDÇÃåÖêîÇ™ïsê≥Ç≈Ç∑ÅB")
            imTextSearchSlbNumber.SetFocus
            Exit Sub
        End If
        'êÊì™Ç©ÇÁÇTï∂éöÇ‹Ç≈ÇÕÅA0Ç©ÇÁ9,*à»äOÇïsâ¬ÅB
        For nI = 1 To 5
            If nI > Len(strSearchSlbNumber) Then Exit For
            strChkChar = Mid(strSearchSlbNumber, nI, 1)
            If strChkChar >= "0" And strChkChar <= "9" Then
                'OK
            ElseIf strChkChar = "%" Then
                'OK
            Else
                'NG
                Call WaitMsgBox(Me, "êÊì™Ç©ÇÁÇTï∂éöÇ‹Ç≈ÅA0Ç©ÇÁ9,*à»äOÇÃéwíËÇÕèoóàÇ‹ÇπÇÒÅB")
                imTextSearchSlbNumber.SetFocus
                Exit Sub
            End If
        Next nI
        
    End If
    
    MsgWnd.MsgText = "ÉfÅ[É^ÉxÅ[ÉXÇåüçıíÜÇ≈Ç∑ÅB" & vbCrLf & "ÇµÇŒÇÁÇ≠Ç®ë“ÇøÇ≠ÇæÇ≥Ç¢ÅB"
    MsgWnd.OK.Visible = False
    MsgWnd.Show vbModeless, Me
    MsgWnd.Refresh
    
    'åüçıåèêî
'    nSEARCH_MAX = APSysCfgData.nSEARCH_MAX(APSlbCont.nSearchInputModeSelectedIndex)
    'bRet = DBSkinSlbSearchRead(APSlbCont.nSearchInputModeSelectedIndex, nSEARCH_MAX, strSearchSlbNumber)
    
    'ÅiåüçıóLå¯îÕàÕÇÕêßå¿Ç†ÇËÅj
    'bRet = DBSkinSlbSearchRead(APSlbCont.nSearchInputModeSelectedIndex, nSEARCH_MAX, APSysCfgData.nSEARCH_RANGE, strSearchSlbNumber)
    
    'ÅiåüçıóLå¯îÕàÕÇÕ9999ñ≥êßå¿Åj
    bRet = DBSkinSlbSearchRead(0, 0, 9999, strSearchSlbNumber)
        
    'åüçıåãâ ÇÉZÉbÉg
    If bRet Then
        
        ReDim APSearchListSlbData(0)
        nJ = 0
        
        Select Case APSlbCont.nSearchInputModeSelectedIndex
            Case 0 'êVãK
                bCmp = False
                nJ = 0
                For nI = 0 To UBound(APSearchTmpSlbData) - 1
                    strTmpSlbNumber = APSearchTmpSlbData(nI).slb_no
                    'Ω◊ÃﬁNoÅDÇî‰är
                    If strTmpSlbNumber = strSearchSlbNumber Then
                        'èÛë‘Çî‰är
                        If CInt(APSearchTmpSlbData(nI).slb_stat) = APSlbCont.nSearchInputStatusSelectedIndex Then
                            bCmp = True 'ë∂ç›
                            APSlbCont.nSearchInputModeSelectedIndex = 1 'êVãKÅÀèCê≥
                            Exit For
                        End If
                    End If
                Next nI
            
                'êVãKÉfÅ[É^çÏê¨í«â¡
                If bCmp = False Then
                    
                    'APSearchListSlbData(nJ).bAPResEdit = False
                    APSearchListSlbData(nJ).bAPScanInput = False
                    APSearchListSlbData(nJ).bAPPdfInput = False
                    
                    APSearchListSlbData(nJ).slb_no = strSearchSlbNumber
                    APSearchListSlbData(nJ).slb_chno = Mid(strSearchSlbNumber, 1, 5)
                    APSearchListSlbData(nJ).slb_aino = Mid(strSearchSlbNumber, 6)
                    
                    APSearchListSlbData(nJ).slb_stat = APSlbCont.nSearchInputStatusSelectedIndex
                    
                    '**********************
                    'ëfçﬁìùäáÇ©ÇÁì«çû
                    'bRet = SOZAI_NCHTAISL_Read(APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_no)
                    
                    bNoRecord = False '2008/08/30 A.K
                    
                    bRet = SOZAI_NCHTAISL_Read(APSearchListSlbData(nJ).slb_no)
                    If UBound(APSozaiTmpData) = 1 Then
                        APSozaiData = APSozaiTmpData(0)
                    Else
                        'NCHTAISLäYìñÉåÉRÅ[Éhñ≥Çµ
                        bNoRecord = True '2008/08/30 A.K
                    End If
                    If bRet = False Then
                        Call WaitMsgBox(Me, "ÉfÅ[É^ÉxÅ[ÉXì«çûÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB")
                        MsgWnd.OK_Close
                        Exit Sub
                    End If
                    
                    'bRet = SOZAI_SKJCHJDT_Read(APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_chno)
                    bRet = SOZAI_SKJCHJDT_Read(APSearchListSlbData(nJ).slb_chno)
                    If UBound(APSozaiTmpData) = 1 Then
                        APSozaiData.slb_chno = APSozaiTmpData(0).slb_chno
                        APSozaiData.slb_ccno = APSozaiTmpData(0).slb_ccno
                        
                        If bNoRecord Then '2008/08/30 A.K
                            'NCHTAISLäYìñÉåÉRÅ[Éhñ≥ÇµÇÃèÍçáÇÃèàóù
                            'SKJCHJDTÇ©ÇÁç|éÌ,å^Çíäèo
                            APSozaiData.slb_ksh = APSozaiTmpData(0).slb_ksh ''ç|éÌ
                            APSozaiData.slb_typ = APSozaiTmpData(0).slb_typ ''å^
                        End If
                        
                    End If
                    If bRet = False Then
                        Call WaitMsgBox(Me, "ÉfÅ[É^ÉxÅ[ÉXì«çûÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB")
                        MsgWnd.OK_Close
                        Exit Sub
                    End If
                    
                    'ÉäÉXÉgÇ…ÉRÉsÅ[
                    '**********************************************************'
                    'nchtaisl
                    'APSozaiTmpData(0).slb_no = "123451234"      ''ÉXÉâÉuNO"
                    APSearchListSlbData(nJ).slb_ksh = APSozaiData.slb_ksh ''ç|éÌ
                    APSearchListSlbData(nJ).slb_uksk = APSozaiData.slb_uksk ''å¸êÊÅiîMâÑå¸êÊÅj
                    'APSearchListSlbData(nJ).slb_lngth = APSozaiData.slb_lngth ''í∑Ç≥
                    'APSearchListSlbData(nJ).slb_color_wei = APSozaiData.slb_color_wei ''èdó Åi∂◊∞¡™Ø∏ópÅFSEGèoë§èdó Åj
                    APSearchListSlbData(nJ).slb_typ = APSozaiData.slb_typ ''å^
                    'APSearchListSlbData(nJ).slb_skin_wei = APSozaiData.slb_skin_wei ''èdó ÅiΩ◊ÃﬁîßópÅFçïîÁèdó Åj
                    'APSearchListSlbData(nJ).slb_wdth = APSozaiData.slb_wdth ''ïù
                    'APSearchListSlbData(nJ).slb_thkns = APSozaiData.slb_thkns ''å˙Ç›
                    APSearchListSlbData(nJ).slb_zkai_dte = APSozaiData.slb_zkai_dte ''ë¢âÚì˙Åië¢âÚîNåéì˙Åj
                    '**********************************************************'
                    'skjchjdtÉeÅ[ÉuÉã
                    'APSozaiData.slb_chno = "12345"        ''É`ÉÉÅ[ÉWNO
                    'APSearchListSlbData(nJ).slb_ccno = APSozaiData.slb_ccno ''CCNO
                    '**********************************************************'
                    
                    '**********************
                    
                    ReDim Preserve APSearchListSlbData(UBound(APSearchListSlbData) + 1)
                    nJ = nJ + 1
                End If
            Case 1 'èCê≥
            Case 2 'çÌèú
        End Select
        
        For nI = 0 To UBound(APSearchTmpSlbData) - 1
            APSearchListSlbData(nJ) = APSearchTmpSlbData(nI)
            ReDim Preserve APSearchListSlbData(UBound(APSearchListSlbData) + 1)
            nJ = nJ + 1
        Next nI
    
    End If

    MsgWnd.OK_Close
    
    ' 20090116 add by M.Aoyagi    ï\é¶ë¨ìxëŒâû
    MSFlexGrid1.Visible = False
    
    'ÉOÉäÉbÉhÇ÷ÉZÉbÉg
    Call SetMSFlexGrid1
    
    ' 20090116 add by M.Aoyagi    ï\é¶ë¨ìxëŒâû
    MSFlexGrid1.Visible = True
    
    ' 20090115 add by M.Aoyagi    èÛë‘ÉLÅ[ïœçXÉ{É^Éìêßå‰
    If OptInputMode(0).Value Then
        ' 20090115 add by M.Aoyagi    êVãKéûÇÕÉLÅ[ïœçXÉÇÅ[ÉhÉ{É^ÉìÇñ≥å¯
        cmdStatChgMode.Enabled = False
        cmdStatChgFix.Enabled = False
    ElseIf OptInputMode(1).Value Then
        ' 20090115 add by M.Aoyagi    èCê≥éûÇÃÇ›ÉLÅ[ïœçXÉÇÅ[ÉhÉ{É^ÉìÇóLå¯
        cmdStatChgMode.Enabled = True
'        cmdStatChgFix.Enabled = True
    ElseIf OptInputMode(2).Value Then
        ' 20090115 add by M.Aoyagi    çÌèúéûÇÕÉLÅ[ïœçXÉÇÅ[ÉhÉ{É^ÉìÇñ≥å¯
        cmdStatChgMode.Enabled = False
        cmdStatChgFix.Enabled = False
    End If
    
End Sub

' @(f)
'
' ã@î\      : ÉXÉâÉuëIëÉçÉbÉNÅ^ÉAÉìÉçÉbÉN
'
' à¯Ç´êî    : ARG1 - True=ÉçÉbÉNÅ^False=ÉAÉìÉçÉbÉN ÉtÉâÉO
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉXÉâÉuëIëèÛë‘ÇÃâÊñ ÉçÉbÉNÅ^ÉAÉìÉçÉbÉNêßå‰ÅB
'
' îıçl      :COLORSYS
'
Private Sub SlbSelLock(ByVal sw As Boolean)
    If sw Then
'        cmdOK.Enabled = True
'        MSFlexGrid1.Enabled = False
'        imTextSearchSlbNumber.Enabled = False
'        cmdSearch.Enabled = False
'        OptSearchMode(0).Enabled = False
'        OptSearchMode(1).Enabled = False
'        OptSearchMode(2).Enabled = False
'        OptSearchMode(3).Enabled = False
'
'        lblSearchMAX(2).Enabled = False
'
'        APSlbCont.bProcessing = True 'ÉXÉâÉuëIëÉçÉbÉNópèàóùíÜÉtÉâÉO
'        APSlbCont.strSearchInputSlbNumber = imTextSearchSlbNumber.Text 'åüçıÉXÉâÉuÇmÇèÅD
'        If OptSearchMode(0).Value Then
'            APSlbCont.nSearchInputModeSelectedIndex = 0 'åüçıÉIÉvÉVÉáÉìéwíËÉCÉìÉfÉbÉNÉXî‘çÜ
'        ElseIf OptSearchMode(1).Value Then
'            APSlbCont.nSearchInputModeSelectedIndex = 1 'åüçıÉIÉvÉVÉáÉìéwíËÉCÉìÉfÉbÉNÉXî‘çÜ
'        ElseIf OptSearchMode(2).Value Then
'            APSlbCont.nSearchInputModeSelectedIndex = 2 'åüçıÉIÉvÉVÉáÉìéwíËÉCÉìÉfÉbÉNÉXî‘çÜ
'        ElseIf OptSearchMode(3).Value Then
'            APSlbCont.nSearchInputModeSelectedIndex = 3 'åüçıÉIÉvÉVÉáÉìéwíËÉCÉìÉfÉbÉNÉXî‘çÜ
'        End If
'        'ÉXÉâÉuëIëèÓïÒï€ë∂
'        APSlbCont.nListSelectedIndexP1 = nMSFlexGrid1_Selected_Row
'        'éqÉXÉâÉuÇÕÇnÇjÉ{É^ÉìéûÇ…ï€ë∂
'        'nChildSelectedIndex As Integer 'éqÉXÉâÉuéwíËÉCÉìÉfÉbÉNÉXî‘çÜ 0ÇÕñ¢éwíË
    Else
'        cmdOK.Enabled = False
'        MSFlexGrid1.Enabled = True
'        imTextSearchSlbNumber.Enabled = True
'        cmdSearch.Enabled = True
'        OptSearchMode(0).Enabled = True
'        OptSearchMode(1).Enabled = True
'        OptSearchMode(2).Enabled = True
'        OptSearchMode(3).Enabled = True
'
'        lblSearchMAX(2).Enabled = True
'
'        APSlbCont.bProcessing = False 'ÉXÉâÉuëIëÉçÉbÉNópèàóùíÜÉtÉâÉO
    End If
    
    Call MSFlexGrid1_Click

    DoEvents

End Sub

' @(f)
'
' ã@î\      : ÉRÅ[ÉãÉoÉbÉNèàóù
'
' à¯Ç´êî    : ARG1 - ÉRÅ[ÉãÉoÉbÉNî‘çÜ
'             ARG2 - ÉRÅ[ÉãÉoÉbÉNñﬂÇË
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉRÅ[ÉãÉoÉbÉNî‘çÜÇ∆ñﬂÇËÇ…âûÇ∂ÇƒÅAéüèàóùÇçsÇ§ÅB
'
' îıçl      :
'
Public Sub CallBackMessage(ByVal CallNo As Integer, ByVal Result As Integer)
    Select Case CallNo
    
    Case CALLBACK_USEIMGDATA
        'ä˘Ç…ìoò^ÉfÅ[É^Ç™ë∂ç›Ç∑ÇÈÉVÉiÉäÉI
        If Result = CALLBACK_ncResOK Then          'OK
            'On Error Resume Next
            'ìoò^çœÇ›ÉXÉLÉÉÉiÅ[ÉCÉÅÅ[ÉW
            
'            Call ImageDataRead
            'ÉCÉÅÅ[ÉWÉtÉ@ÉCÉãì«çûÇ›
            'Call ImageLoad
            
            
            'On Error GoTo 0
            'Unload Me
        Else
            
        End If
'        cmdSplitChg.Enabled = True
    Case CALLBACK_RES_SKINDATA_DBDEL_REQ
        'ÉfÅ[É^çÌèúÇÃñ‚çáÇπÇÊÇËOK
        If Result = CALLBACK_ncResOK Then          'OK
            Call SkinDataDel   'çÌèúèàóùé¿çs
        Else
            
        End If
        
        cmdOK.Enabled = True 'É{É^ÉìóLå¯
    Case CALLBACK_RES_STATECHANGE_SKIN
        'èÛë‘ÉLÅ[ïœçXOK
        If Result = CALLBACK_ncResOK Then          'OK
            Call cmdStatChgFixExe
        Else
            cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
            Call WaitMsgBox(Me, "èÛë‘ïœçXèàóùÇíÜífÇµÇ‹ÇµÇΩÅB")
        End If
    End Select

End Sub

' @(f)
'
' ã@î\      : ÉOÉäÉbÉhÇPèâä˙âª
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉOÉäÉbÉhÇPÇÃèâä˙âªÇçsÇ§ÅB
'
' îıçl      :
'
Private Sub InitMSFlexGrid1()

    Dim nJ As Integer
    Dim nRow As Integer
    Dim nCol As Integer

    nMSFlexGrid1_Selected_Row = 0
    lbl_nMSFlexGrid1_Selected_Row.Caption = nMSFlexGrid1_Selected_Row
    
    MSFlexGrid1.SelectionMode = flexSelectionByRow
    MSFlexGrid1.FixedCols = 0
    ' 20090115 modify by M.Aoyagi    âÊëúñáêîïœçXÇÃà◊â¡éZ
'    MSFlexGrid1.Cols = 9 + 1
    MSFlexGrid1.Cols = 10 + 1
    MSFlexGrid1.Rows = 1
    
    nRow = 0
    nCol = 0
    MSFlexGrid1.ColWidth(nCol) = 0
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = ""
    
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1400
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "ç|éÌ"
    
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1600
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "ÉXÉâÉuNo."
    
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1000
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "å^"
    
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1000
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "å¸êÊ"
    
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1000
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "èÛë‘"
    
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1600
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "ë¢âÚì˙"
    
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1600
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "Ω◊Ãﬁîßé¿ê—"
    
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1600
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "Ω◊Ãﬁîß≤“∞ºﬁ"
    
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1600
    'MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "Ω◊ÃﬁîßPDF"
    
    ' 20090115 add by M.Aoyagi    âÊëúñáêîí«â¡
    nCol = nCol + 1
    MSFlexGrid1.ColWidth(nCol) = 1000
    MSFlexGrid1.ColAlignment(nCol) = FlexAlignCenter
    MSFlexGrid1.Row = nRow
    MSFlexGrid1.Col = nCol
    MSFlexGrid1.CellAlignment = flexAlignCenterCenter
    MSFlexGrid1.TextMatrix(0, nCol) = "âÊëúêî"
    
    'É^ÉCÉgÉãçs
    For nJ = 1 To MSFlexGrid1.Cols - 1
        MSFlexGrid1.Row = 0
        MSFlexGrid1.Col = nJ
        MSFlexGrid1.CellForeColor = &H80000012
        MSFlexGrid1.CellBackColor = &H8000000F
    Next nJ

End Sub

' @(f)
'
' ã@î\      : ÉOÉäÉbÉhÇPÉfÅ[É^ÉZÉbÉg
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉOÉäÉbÉhÇPÇÃÉfÅ[É^ÉZÉbÉgÇçsÇ§ÅB
'
' îıçl      :
'
Private Sub SetMSFlexGrid1()
    Dim nJ As Integer
    Dim nCol As Integer
    Dim nRow As Integer
    
    MSFlexGrid1.Rows = 1 + UBound(APSearchListSlbData)
    
    For nRow = 1 To MSFlexGrid1.Rows - 1
    
        nCol = 0
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = ""
        
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = APSearchListSlbData(nRow - 1).slb_ksh '"ç|éÌ"
        
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignLeftCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = APSearchListSlbData(nRow - 1).slb_chno & "-" & APSearchListSlbData(nRow - 1).slb_aino '"ÉXÉâÉuNo."
        
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = APSearchListSlbData(nRow - 1).slb_typ '"å^"
        
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = APSearchListSlbData(nRow - 1).slb_uksk '"å¸êÊ"
        
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = ConvDpOutStat(conDefine_SYSMODE_SKIN, CInt(APSearchListSlbData(nRow - 1).slb_stat)) '"èÛë‘"
        
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = APSearchListSlbData(nRow - 1).slb_zkai_dte '"ë¢âÚì˙"
        
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = APSearchListSlbData(nRow - 1).sys_wrt_dte '"Ω◊Ãﬁîßé¿ê—"ÅièââÒìoò^ì˙Åj
    
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = IIf(APSearchListSlbData(nRow - 1).bAPScanInput, "Åõ", "") '"Ω◊Ãﬁîß≤“∞ºﬁ"
    
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        If APSearchListSlbData(nRow - 1).bAPPdfInput Then
            MSFlexGrid1.TextMatrix(nRow, nCol) = "Åõ"
        ElseIf APSearchListSlbData(nRow - 1).sAPPdfInput_ReqDate <> "" Then
            MSFlexGrid1.TextMatrix(nRow, nCol) = "Å¢"
        Else
            MSFlexGrid1.TextMatrix(nRow, nCol) = ""
        End If
        'MSFlexGrid1.TextMatrix(nRow, nCol) = IIf(APSearchListSlbData(nRow - 1).bAPPdfInput, "Åõ", "") '"Ω◊ÃﬁîßPDF"
    
        ' 20090115 add by M.Aoyagi    âÊëúñáêîï\é¶í«â¡ÇÃà◊
        nCol = nCol + 1
        MSFlexGrid1.Row = nRow
        MSFlexGrid1.Col = nCol
        MSFlexGrid1.CellAlignment = flexAlignCenterCenter
        MSFlexGrid1.TextMatrix(nRow, nCol) = APSearchListSlbData(nRow - 1).PhotoImgCnt1
    
    Next nRow

    If MSFlexGrid1.Rows > 1 Then
        MSFlexGrid1.Row = 1
    End If

End Sub

' @(f)
'
' ã@î\      : èÛë‘åàíËÉ{É^Éì
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉeÅ[ÉuÉãÅAIMGÉtÉ@ÉCÉãÅAPDFÉtÉ@ÉCÉãÅASCANÉtÉ@ÉCÉãÇÃèÛë‘ÉLÅ[ÇïœçXÇ∑ÇÈÅB
'
' îıçl      :
'
Private Sub cmdStatChgFix_Click()
    Dim bRet      As Boolean
    Dim strSource As String
    Dim strDestination As String
    Dim sSlbno    As String
    Dim sChno     As String
    Dim sAino     As String
    Dim sStat     As String
    Dim sCol      As String
    Dim sStatNew  As String
    Dim sCheckErr As String
    
    Dim fmessage As Object
    Set fmessage = New MessageYN

    cmdStatChgFix.Enabled = False       'É{É^Éìñ≥å¯
    
    ' èÛë‘ïœçXäJénÉçÉOèëçûÇ›
    Call MsgLog(conProcNum_MAIN, "èÛë‘ïœçXÇäJénÇµÇ‹Ç∑ÅB")

    'ÉXÉâÉuëIëÉ`ÉFÉbÉN
    APSlbCont.nListSelectedIndexP1 = nMSFlexGrid1_Selected_Row
    If APSlbCont.nListSelectedIndexP1 = 0 Then
        Call WaitMsgBox(Me, "ÅwèÛë‘ÅxïœçXÇçsÇ§ÉXÉâÉuÇëIëÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB")
        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
        Exit Sub
    End If
    
    ' ïKóvÉfÅ[É^ê›íË
    sSlbno = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_no
    sChno = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_chno
    sAino = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_aino
    sStat = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_stat
    sCol = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_col_cnt
    If OptStatus(0).Value Then
        sStatNew = "0" 'çïîÁ
    ElseIf OptStatus(1).Value Then
        sStatNew = "1" '1htå„
    ElseIf OptStatus(2).Value Then
        sStatNew = "2" '2htå„
    ElseIf OptStatus(3).Value Then
        sStatNew = "3" '3htå„
    ElseIf OptStatus(4).Value Then
        sStatNew = "4" '4htå„
    ElseIf OptStatus(5).Value Then
        sStatNew = "5" '5htå„
    ElseIf OptStatus(6).Value Then
        sStatNew = "6" '6htå„
    End If

    ' ïœçXêÊÇÃÉfÅ[É^Ç™ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉN **********************************************************
    bRet = DBStatChgCheckSKIN(APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_no, sStatNew)
    If bRet = False Then
        sCheckErr = "ä˘Ç…ÉfÅ[É^Ç™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB"
    End If
    
    ' IMGÉtÉHÉãÉ_Ç™ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉN *************************************************************
'    PhotoImgCount("SKIN", oDS.Fields("slb_chno").Value, oDS.Fields("slb_aino").Value, oDS.Fields("slb_stat").Value, "00")
    bRet = StatChgFoldCheck("IMG", "SKIN", sChno, sAino, sStatNew, "00")
    If bRet = False Then
        If sCheckErr = "" Then
            sCheckErr = "ä˘Ç…âÊëúÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB"
        Else
            sCheckErr = sCheckErr & vbCrLf & "ä˘Ç…âÊëúÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB"
        End If
    End If
    
    ' PDFÉtÉHÉãÉ_Ç™ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉN *************************************************************
    bRet = StatChgFoldCheck("PDF", "SKIN", sChno, sAino, sStatNew, "00")
    If bRet = False Then
        If sCheckErr = "" Then
            sCheckErr = "ä˘Ç…PDFÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB"
        Else
            sCheckErr = sCheckErr & vbCrLf & "ä˘Ç…PDFÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB"
        End If
    End If
    
    ' SCANÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉN ************************************************************
    bRet = StatChgFoldCheck("SCAN", "SKIN", sChno, sAino, sStatNew, "00")
    If bRet = False Then
        If sCheckErr = "" Then
            sCheckErr = "ä˘Ç…ÉXÉLÉÉÉìÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB"
        Else
            sCheckErr = sCheckErr & vbCrLf & "ä˘Ç…ÉXÉLÉÉÉìÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB"
        End If
    End If

    'ä˘ë∂ÉtÉ@ÉCÉãÉ`ÉFÉbÉNç≈èIämîF *****************************************************************
    If sCheckErr <> "" Then
        Call WaitMsgBox(Me, sCheckErr)
        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
        Exit Sub
    End If

    'èÛë‘ïœçXé¿çsämîF
    fmessage.MsgText = "éwíËÉfÅ[É^ÇÃèÛë‘ÉLÅ[ÇïœçXÇµÇ‹Ç∑ÅB" & vbCrLf & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH"
    fmessage.AutoDelete = False
    fmessage.SetCallBack Me, CALLBACK_RES_STATECHANGE_SKIN, False
    fmessage.Show vbModal, Me 'ëºÇÃèàóùÇïsâ¬Ç∆Ç∑ÇÈà◊ÅAvbModalÇ∆Ç∑ÇÈÅB
    Set fmessage = Nothing
End Sub

' @(f)
'
' ã@î\      : èÛë‘åàíËèàóù
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉeÅ[ÉuÉãÅAIMGÉtÉ@ÉCÉãÅAPDFÉtÉ@ÉCÉãÅASCANÉtÉ@ÉCÉãÇÃèÛë‘ÉLÅ[ÇïœçXÇ∑ÇÈÅB
'
' îıçl      :
'
Private Sub cmdStatChgFixExe()
    Dim bRet      As Boolean
    Dim strSource As String
    Dim strDestination As String
    Dim sSlbno    As String
    Dim sChno     As String
    Dim sAino     As String
    Dim sStat     As String
    Dim sCol      As String
    Dim sStatNew  As String
    
    cmdStatChgFix.Enabled = False       'É{É^Éìñ≥å¯
    
    ' èÛë‘ïœçXäJénÉçÉOèëçûÇ›
'    Call MsgLog(conProcNum_MAIN, "èÛë‘ïœçXÇäJénÇµÇ‹Ç∑ÅB")
    
    ' ïKóvÉfÅ[É^ê›íË
    sSlbno = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_no
    sChno = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_chno
    sAino = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_aino
    sStat = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_stat
    sCol = APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_col_cnt
    If OptStatus(0).Value Then
        sStatNew = "0" 'çïîÁ
    ElseIf OptStatus(1).Value Then
        sStatNew = "1" '1htå„
    ElseIf OptStatus(2).Value Then
        sStatNew = "2" '2htå„
    ElseIf OptStatus(3).Value Then
        sStatNew = "3" '3htå„
    ElseIf OptStatus(4).Value Then
        sStatNew = "4" '4htå„
    ElseIf OptStatus(5).Value Then
        sStatNew = "5" '5htå„
    ElseIf OptStatus(6).Value Then
        sStatNew = "6" '6htå„
    End If

'    ' ïœçXêÊÇÃÉfÅ[É^Ç™ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉN **********************************************************
'    bRet = DBStatChgCheckSKIN(APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_no, sStatNew)
'    If bRet = 1 Then
'        Call WaitMsgBox(Me, "ä˘Ç…ÉfÅ[É^Ç™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB")
'        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
'        Exit Sub
'    ElseIf bRet = 2 Then
'        Call WaitMsgBox(Me, "éwé¶ÉfÅ[É^Ç™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB")
'        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
'        Exit Sub
'    End If
'
'    ' IMGÉtÉHÉãÉ_Ç™ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉN *************************************************************
''    PhotoImgCount("SKIN", oDS.Fields("slb_chno").Value, oDS.Fields("slb_aino").Value, oDS.Fields("slb_stat").Value, "00")
'    bRet = StatChgFoldCheck("IMG", "SKIN", sChno, sAino, sStatNew, "00")
'    If bRet = False Then
'        Call WaitMsgBox(Me, "ä˘Ç…âÊëúÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB")
'        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
'        Exit Sub
'    End If
'
'    ' PDFÉtÉHÉãÉ_Ç™ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉN *************************************************************
'    bRet = StatChgFoldCheck("PDF", "SKIN", sChno, sAino, sStatNew, "00")
'    If bRet = False Then
'        Call WaitMsgBox(Me, "ä˘Ç…PDFÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB")
'        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
'        Exit Sub
'    End If
'
'    ' SCANÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉN ************************************************************
'    bRet = StatChgFoldCheck("SCAN", "SKIN", sChno, sAino, sStatNew, "00")
'    If bRet = False Then
'        Call WaitMsgBox(Me, "ä˘Ç…ÉXÉLÉÉÉìÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇÃÇ≈ïœçXÇ≈Ç´Ç‹ÇπÇÒÅB")
'        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
'        Exit Sub
'    End If
    
    ' IMGÉtÉ@ÉCÉãïœçX *****************************************************************************
    bRet = StatChgFoldFix("IMG", "SKIN", sChno, sAino, sStat, sStatNew, "00", "00")
    If bRet = False Then
        Call WaitMsgBox(Me, "âÊëúÉtÉ@ÉCÉãÇÃïœçXÇ…é∏îsÇµÇ‹ÇµÇΩÅB")
        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
        Exit Sub
    End If
    
    ' PDFÉtÉ@ÉCÉãïœçX *****************************************************************************
    bRet = StatChgFoldFix("PDF", "SKIN", sChno, sAino, sStat, sStatNew, "00", "00")
    If bRet = False Then
        Call WaitMsgBox(Me, "PDFÉtÉ@ÉCÉãÇÃïœçXÇ…é∏îsÇµÇ‹ÇµÇΩÅB")
        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
        Exit Sub
    End If
    
    ' SCANÉtÉ@ÉCÉãïœçX ****************************************************************************
    bRet = StatChgFoldFix("SCAN", "SKIN", sChno, sAino, sStat, sStatNew, "00", "00")
    If bRet = False Then
        Call WaitMsgBox(Me, "ÉXÉLÉÉÉìÉtÉ@ÉCÉãÇÃïœçXÇ…é∏îsÇµÇ‹ÇµÇΩÅB")
        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
        Exit Sub
    End If

    ' ÉeÅ[ÉuÉãïœçX ********************************************************************************
'    bRet = DBStatChgFix(APSearchListSlbData(APSlbCont.nListSelectedIndexP1 - 1).slb_no, sStatNew)
    bRet = DBStatChgFixSKIN(sSlbno, sChno, sAino, sStat, sStatNew)
    If bRet = False Then
        Call WaitMsgBox(Me, "ÉfÅ[É^ÇÃïœçXÇ…é∏îsÇµÇ‹ÇµÇΩÅB")
        cmdStatChgFix.Enabled = True            'É{É^ÉìóLå¯
        Exit Sub
    End If

    Call WaitMsgBox(Me, "èÛë‘ïœçXÇÕê≥èÌÇ…èIóπÇµÇ‹ÇµÇΩÅB" & vbCrLf & "PDFÇÃçƒçÏê¨ÇÕéËìÆÇ≈çsÇ»Ç¡Çƒâ∫Ç≥Ç¢ÅB")
    cmdStatChgFix.Enabled = True        'É{É^ÉìóLå¯

    ' âÊñ çXêV
    Call cmdSearch_Click
    
End Sub

' @(f)
'
' ã@î\      : èÛë‘ïœçXÉ{É^Éì
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : èÛë‘ïœçXÇÃà◊ÅAèÛë‘ÉIÉvÉVÉáÉìÉ{É^ÉìÇóLå¯Ç…Ç∑ÇÈÅB
'
' îıçl      :
'
Private Sub cmdStatChgMode_Click()
    Dim i As Integer

    ' 20090115 add by M.Aoyagi    èÛë‘ÇïœçXâ¬î\Ç…Ç∑ÇÈ
    Frame_Status.Enabled = True 'óLå¯
    For i = 0 To 6
        OptStatus(i).Enabled = True
    Next i

    ' èÛë‘åàíËÉ{É^ÉìÇóLå¯Ç…Ç∑ÇÈ
    cmdStatChgFix.Enabled = True

End Sub

Private Sub imTextSearchSlbNumber_KeyDown(KeyCode As Integer, Shift As Integer)
    Select Case KeyCode
        Case vbKeyReturn
            SendKeys "{TAB}", True
    End Select
End Sub

' @(f)
'
' ã@î\      : ÉXÉâÉuî‘çÜì¸óÕBOXÉLÅ[âü
'
' à¯Ç´êî    : ARG1 - ASCIIÉRÅ[Éh
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉXÉâÉuî‘çÜì¸óÕBOXÉLÅ[âüéûÇÃèàóùÇçsÇ§ÅB
'
' îıçl      :
'
Private Sub imTextSearchSlbNumber_KeyPress(KeyAscii As Integer)
    Dim nI As Integer
    
    If KeyAscii >= Asc("0") And KeyAscii <= Asc("9") Then
    ElseIf KeyAscii >= Asc("a") And KeyAscii <= Asc("z") Then
    ElseIf KeyAscii >= Asc("A") And KeyAscii <= Asc("Z") Then
    ElseIf KeyAscii = Asc("-") Then
    ElseIf KeyAscii = Asc("*") Then
        'For nI = 1 To LenB(imTextSearchSlbNumber.Text)
        '    If Mid(imTextSearchSlbNumber.Text, nI, 1) = "*" Then
        '        KeyAscii = 0
        '        Beep
        '    End If
        'Next nI
    Else
        If KeyAscii <> 10 And KeyAscii <> 13 And KeyAscii <> 8 Then
            KeyAscii = 0
            Beep
        End If
    End If
End Sub

' @(f)
'
' ã@î\      : ÉOÉäÉbÉhÇPÉNÉäÉbÉN
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉOÉäÉbÉhÇPÉNÉäÉbÉNéûÇÃèàóùÇçsÇ§ÅB
'
' îıçl      :
'
Private Sub MSFlexGrid1_Click()
    Dim nJ As Integer
    Dim nNowRow As Integer
    Dim nNowSplitNum As Integer
    Dim nRet As Integer

    ' 20090116 add by M.Aoyagi    ï\é¶ë¨ìxëŒâû
    MSFlexGrid1.Visible = False

    bMouseControl = True

    'åªç›ÇÃRowÇàÍéûï€ë∂
    nNowRow = MSFlexGrid1.Row

    'à»ëOÇÃÉZÉåÉNÉgçsÇñ¢ÉZÉåÉNÉgèÛë‘Ç…ñﬂÇ∑ÅB
    If nMSFlexGrid1_Selected_Row <> 0 Then
        For nJ = 1 To MSFlexGrid1.Cols - 1
        MSFlexGrid1.Row = nMSFlexGrid1_Selected_Row
        MSFlexGrid1.Col = nJ
        MSFlexGrid1.CellForeColor = &H80000008
        MSFlexGrid1.CellBackColor = &H80000005
        Next nJ
    Else
        'É^ÉCÉgÉãçsÇÃêFÇïtÇØíºÇ∑ÅB
        For nJ = 1 To MSFlexGrid1.Cols - 1
        MSFlexGrid1.Row = nMSFlexGrid1_Selected_Row
        MSFlexGrid1.Col = nJ
        MSFlexGrid1.CellForeColor = &H80000012
        MSFlexGrid1.CellBackColor = &H8000000F
        Next nJ
    End If

    'åªç›ÇÃÉZÉåÉNÉgçsî‘çÜÇï€ë∂
    nMSFlexGrid1_Selected_Row = nNowRow
    lbl_nMSFlexGrid1_Selected_Row.Caption = nMSFlexGrid1_Selected_Row
    
    'åªç›ÇÃçsÇÉZÉåÉNÉgçsÇ…Ç∑ÇÈÅB
    If nMSFlexGrid1_Selected_Row <> 0 Then
        For nJ = 1 To MSFlexGrid1.Cols - 1
            MSFlexGrid1.Row = nMSFlexGrid1_Selected_Row
            MSFlexGrid1.Col = nJ
            If MSFlexGrid1.Enabled Then
                'ëIëíÜÇÃêF
                If APSlbCont.nSearchInputModeSelectedIndex = 2 Then
                    'çÌèúÉÇÅ[ÉhÇÃèÍçá
                    MSFlexGrid1.CellForeColor = &H8000000E
                    MSFlexGrid1.CellBackColor = &H8080FF
                Else
                    MSFlexGrid1.CellForeColor = &H8000000E
                    MSFlexGrid1.CellBackColor = &H8000000D
                End If
            Else
                'ëIëÉçÉbÉNíÜÇÃêF
                MSFlexGrid1.CellForeColor = &H8000000E
                MSFlexGrid1.CellBackColor = &H808080
            End If
        Next nJ
        If MSFlexGrid1.Enabled Then
            'ëIëíÜ
        Else
            'ëIëÉçÉbÉN
        End If
    
    Else
    End If

    ' 20090116 add by M.Aoyagi    ï\é¶ë¨ìxëŒâû
    MSFlexGrid1.Visible = True

End Sub

' @(f)
'
' ã@î\      : ÉOÉäÉbÉhÇPÉtÉHÅ[ÉJÉXéÊìæ
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉOÉäÉbÉhÇPÉtÉHÅ[ÉJÉXéÊìæéûÇÃèàóùÇçsÇ§ÅB
'
' îıçl      :
'
Private Sub MSFlexGrid1_GotFocus()
    If nMSFlexGrid1_Selected_Row = 0 Then
        If MSFlexGrid1.Rows > 1 Then
            'MSFlexGrid1.Row = 1
            'Debug.Print MSFlexGrid1.Row
            Call MSFlexGrid1_Click
        End If
    End If
End Sub

' @(f)
'
' ã@î\      : ÉOÉäÉbÉhÇPÉZÉãïœçX
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉOÉäÉbÉhÇPÉZÉãïœçXéûÇÃèàóùÇçsÇ§ÅB
'
' îıçl      :
'
Private Sub MSFlexGrid1_SelChange()
    If bMouseControl = False Then
        Call MSFlexGrid1_Click
    End If
    bMouseControl = False
End Sub

' @(f)
'
' ã@î\      : ÉtÉHÅ[ÉÄÉçÅ[Éh
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ÉtÉHÅ[ÉÄÉçÅ[ÉhéûÇÃèàóùÇçsÇ§ÅB
'
' îıçl      :
'
Private Sub Form_Load()
    
    Dim nI As Integer
    
    bMouseControl = False
    
'    For nI = 0 To 3
'        lblSearchMAX(nI).Caption = APSysCfgData.nSEARCH_MAX(nI)
'    Next nI
    
    'ëIëî‘çÜï\é¶
    If IsDEBUG("DISP") Then
        lbl_nMSFlexGrid1_Selected_Row.Visible = True
'        lbl_nMSFlexGrid2_Selected_Row.Visible = True
    End If
    
'    cmdOK.Enabled = False
    
'    LEAD_SCAN.UnlockSupport L_SUPPORT_DOCUMENT, L_KEY_DOCUMENT
'    LEAD_SCAN.EnableMethodErrors = False 'False   ÉVÉXÉeÉÄÉGÉâÅ[ÉCÉxÉìÉgÇî≠ê∂Ç≥ÇπÇ»Ç¢
'    LEAD_SCAN.EnableTwainEvent = True
'    LEAD_SCAN.PaintZoomFactor = APSysCfgData.nIMAGE_SIZE(conDefine_SYSMODE_SKIN)
'
'    For nI = 0 To 1
'        LEAD1(nI).UnlockSupport L_SUPPORT_DOCUMENT, L_KEY_DOCUMENT
'        LEAD1(nI).EnableMethodErrors = False 'False   ÉVÉXÉeÉÄÉGÉâÅ[ÉCÉxÉìÉgÇî≠ê∂Ç≥ÇπÇ»Ç¢
'        LEAD1(nI).EnableTwainEvent = True
'        LEAD1(nI).PaintZoomFactor = APSysCfgData.nIMAGE_SIZE(conDefine_SYSMODE_SKIN)
'    Next nI
    
    Call InitMSFlexGrid1

'    If APSlbCont.bProcessing Then 'ÉXÉâÉuëIëÉçÉbÉNópèàóùíÜÉtÉâÉO
        imTextSearchSlbNumber.Text = APSlbCont.strSearchInputSlbNumber  'åüçıÉXÉâÉuÇmÇèÅD
        
        OptInputMode(APSlbCont.nSearchInputModeSelectedIndex).Value = True 'ì¸óÕÉÇÅ[ÉhéwíËÉCÉìÉfÉbÉNÉXî‘çÜ
        
        bOptInputModeValue(0) = IIf(APSlbCont.nSearchInputModeSelectedIndex = 0, True, False)
        bOptInputModeValue(1) = IIf(APSlbCont.nSearchInputModeSelectedIndex = 1, True, False)
        bOptInputModeValue(2) = IIf(APSlbCont.nSearchInputModeSelectedIndex = 2, True, False)
        
        OptStatus(APSlbCont.nSearchInputStatusSelectedIndex).Value = True 'èÛë‘ëIëéwíËÉCÉìÉfÉbÉNÉXî‘çÜ
        
        ' 20090115 add by M.Aoyagi    ÉLÅ[ïœçXÉÇÅ[ÉhÉ{É^ÉìÇÃèâä˙ê›íË
        cmdStatChgMode.Enabled = False
        cmdStatChgFix.Enabled = False
        
        'ÉXÉâÉuëIëèÓïÒ
        nMSFlexGrid1_Selected_Row = APSlbCont.nListSelectedIndexP1
        Call SetMSFlexGrid1
        MSFlexGrid1.Row = nMSFlexGrid1_Selected_Row
        Call MSFlexGrid1_Click
        Call SlbSelLock(True)
        
'    End If

End Sub

' @(f)
'
' ã@î\      : ì¸óÕÉÇÅ[ÉhÉIÉvÉVÉáÉìÉNÉäÉbÉN
'
' à¯Ç´êî    : ARG1 - ÉCÉìÉfÉbÉNÉXî‘çÜ
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ì¸óÕÉÇÅ[ÉhÉIÉvÉVÉáÉìÉNÉäÉbÉNéûÇÃèàóùÇçsÇ§ÅB
'
' îıçl      :conDefine_ColorActive or conDefine_ColorNotActive
'           :COLORSYS
'
Private Sub OptInputMode_Click(Index As Integer)
    Dim i As Integer
    
    Select Case Index
        Case 0 'êVãK
            If OptInputMode(Index).Value Then
                imTextSearchSlbNumber.Enabled = True
                imTextSearchSlbNumber.BackColor = conDefine_ColorActive
                
                Frame_Status.Enabled = True 'óLå¯
                For i = 0 To 6
                    OptStatus(i).Enabled = True
                Next i
            End If
            
            ' 20090115 add by M.Aoyagi    êVãKéûÇÕÉLÅ[ïœçXÉÇÅ[ÉhÉ{É^ÉìÇñ≥å¯
            cmdStatChgMode.Enabled = False
            cmdStatChgFix.Enabled = False
        Case 1 'èCê≥
            If OptInputMode(Index).Value Then
                imTextSearchSlbNumber.Enabled = True
                imTextSearchSlbNumber.BackColor = conDefine_ColorActive
            End If
        
                Frame_Status.Enabled = False 'ñ≥å¯
                For i = 0 To 6
                    OptStatus(i).Enabled = False
                Next i
        Case 2 'çÌèú
            If OptInputMode(Index).Value Then
                imTextSearchSlbNumber.Enabled = True
                imTextSearchSlbNumber.BackColor = conDefine_ColorActive
            End If
    
            Frame_Status.Enabled = False 'ñ≥å¯
            For i = 0 To 6
                OptStatus(i).Enabled = False
            Next i
        
            ' 20090115 add by M.Aoyagi    çÌèúéûÇÕÉLÅ[ïœçXÉÇÅ[ÉhÉ{É^ÉìÇñ≥å¯
            cmdStatChgMode.Enabled = False
            cmdStatChgFix.Enabled = False
    End Select

    If bOptInputModeValue(Index) = False Then
        'ïœâªÇ™Ç†Ç¡ÇΩèÍçá
        For i = 0 To 2
            bOptInputModeValue(i) = False
        Next i
        bOptInputModeValue(Index) = True
        
        nMSFlexGrid1_Selected_Row = 0
        APSlbCont.nListSelectedIndexP1 = 0
        
        'ÉXÉâÉuåüçıÉäÉXÉgÉNÉäÉA
        ReDim APSearchListSlbData(0)
        'ÉOÉäÉbÉhÇ÷ÉZÉbÉg
        Call SetMSFlexGrid1
        
    End If

End Sub

' @(f)
'
' ã@î\      : ì¸óÕÉÇÅ[ÉhÉIÉvÉVÉáÉìÉtÉHÅ[ÉJÉXéÊìæ
'
' à¯Ç´êî    : ARG1 - ÉCÉìÉfÉbÉNÉXî‘çÜ
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : ì¸óÕÉÇÅ[ÉhÉIÉvÉVÉáÉìÉtÉHÅ[ÉJÉXéÊìæéûÇÃèàóùÇçsÇ§ÅB
'
' îıçl      :COLORSYS
'
Private Sub OptInputMode_GotFocus(Index As Integer)
    Dim i As Integer
    
    Select Case Index
        Case 0 'êVãK
            If OptInputMode(Index).Value Then
                imTextSearchSlbNumber.Enabled = True
                imTextSearchSlbNumber.BackColor = conDefine_ColorActive
                
                Frame_Status.Enabled = True 'óLå¯
                For i = 0 To 6
                    OptStatus(i).Enabled = True
                Next i
            End If
        Case 1 'èCê≥
            If OptInputMode(Index).Value Then
                imTextSearchSlbNumber.Enabled = True
                imTextSearchSlbNumber.BackColor = conDefine_ColorActive
            End If
        
                Frame_Status.Enabled = False 'ñ≥å¯
                For i = 0 To 6
                    OptStatus(i).Enabled = False
                Next i
        Case 2 'çÌèú
            If OptInputMode(Index).Value Then
                imTextSearchSlbNumber.Enabled = True
                imTextSearchSlbNumber.BackColor = conDefine_ColorActive
            End If
    
                Frame_Status.Enabled = False 'ñ≥å¯
                For i = 0 To 6
                    OptStatus(i).Enabled = False
                Next i
    End Select
End Sub

' @(f)
'
' ã@î\      : çÌèúñ‚çáÇπ
'
' à¯Ç´êî    :
'
' ï‘ÇËíl    :
'
' ã@î\ê‡ñæ  : çÌèúñ‚çáÇπèàóùÅB
'
' îıçl      :
'
Private Sub SkinDataDel_REQ()

    Dim bHostSendCmp As Boolean

    Dim fmessage As Object
    Set fmessage = New MessageYN

    fmessage.MsgText = "ëIëÇµÇΩÉfÅ[É^ÇçÌèúÇµÇ‹Ç∑ÅB" & vbCrLf & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH"
'    fmessage.AutoDelete = True
    fmessage.AutoDelete = False
    fmessage.SetCallBack Me, CALLBACK_RES_SKINDATA_DBDEL_REQ, False

'        Do
'            On Error Resume Next
'            fmessage.Show vbModeless, Me
'            If Err.Number = 0 Then
'                Exit Do
'            End If
'            DoEvents
'        Loop
    fmessage.Show vbModal, Me 'ëºÇÃèàóùÇïsâ¬Ç∆Ç∑ÇÈà◊ÅAvbModalÇ∆Ç∑ÇÈÅB
    Set fmessage = Nothing
'    End If

End Sub


